import{o as le,i as se,I as O,b as G,r as J,h as ie,a as oe}from"./Icon.DPcHWoV_.js";import{j as ce,k as P,n as fe,g,o as ue,q as de,H as ve,u as K,v as Q,w as V,x as H,C as he,y as pe,z as ge,A as me,B as Y,D as te,E as xe,m as F,F as X,G as ae,I as _e,J as be,K as re,L as we,M as ke,N as ye,O as z,P as Ee,Q as Ce,R as Se,S as Te,T as Ie,l as W,a as Le,f as ne,U as Me,e as Z,b as j,p as Ae,h as A,c as Ne,d as N,r as R,t as Re,V as B,i as ee,s as q}from"./render.Chp2NGvu.js";import{u as $e}from"./url-utils.uEDIkcjJ.js";/* empty css                        */function De(t,n){return n}function Pe(t,n,r){for(var _=[],m=n.length,d=0;d<m;d++)Ce(n[d].e,_,!0);Se(_,()=>{var i=_.length===0&&r!==null;if(i){var a=r,x=a.parentNode;Te(x),x.append(a),t.items.clear(),T(t,n[0].prev,n[m-1].next)}for(var e=0;e<m;e++){var u=n[e];i||(t.items.delete(u.k),T(t,u.prev,u.next)),Ie(u.e,!i)}t.first===n[0]&&(t.first=n[0].prev)})}function qe(t,n,r,_,m,d=null){var i=t,a=new Map,x=null;P&&fe();var e=null,u=ue(()=>{var w=r();return _e(w)?w:w==null?[]:ae(w)}),h,b=!0;function C(){Oe(I,h,i,n,_),e!==null&&(h.length===0?(e.fragment?(i.before(e.fragment),e.fragment=null):re(e.effect),l.first=e.effect):we(e.effect,()=>{e=null}))}var l=ce(()=>{h=g(u);var w=h.length;let S=!1;if(P){var E=de(i)===ve;E!==(w===0)&&(i=K(),Q(i),V(!1),S=!0)}for(var M=new Set,L=me,s=null,o=xe(),f=0;f<w;f+=1){P&&H.nodeType===he&&H.data===pe&&(i=H,S=!0,V(!1));var c=h[f],p=_(c,f),v=b?null:a.get(p);v?(ge(v.v,c),v.i=f,o&&L.skipped_effects.delete(v.e)):(v=He(b?i:null,s,c,p,f,m,n,r),b&&(v.o=!0,s===null?x=v:s.next=v,s=v),a.set(p,v)),M.add(p)}if(w===0&&d&&!e)if(b)e={fragment:null,effect:Y(()=>d(i))};else{var k=document.createDocumentFragment(),y=te();k.append(y),e={fragment:k,effect:Y(()=>d(y))}}if(P&&w>0&&Q(K()),!b)if(o){for(const[$,D]of a)M.has($)||L.skipped_effects.add(D.e);L.oncommit(C),L.ondiscard(()=>{})}else C();S&&V(!0),g(u)}),I={effect:l,items:a,first:x};b=!1,P&&(i=H)}function Oe(t,n,r,_,m){var d=n.length,i=t.items,a=t.first,x,e=null,u=[],h=[],b,C,l,I;for(I=0;I<d;I+=1){if(b=n[I],C=m(b,I),l=i.get(C),t.first??=l,!l.o){l.o=!0;var w=e?e.next:a;T(t,e,l),T(t,l,w),U(l,w,r),e=l,u=[],h=[],a=e.next;continue}if((l.e.f&z)!==0&&re(l.e),l!==a){if(x!==void 0&&x.has(l)){if(u.length<h.length){var S=h[0],E;e=S.prev;var M=u[0],L=u[u.length-1];for(E=0;E<u.length;E+=1)U(u[E],S,r);for(E=0;E<h.length;E+=1)x.delete(h[E]);T(t,M.prev,L.next),T(t,e,M),T(t,L,S),a=S,e=L,I-=1,u=[],h=[]}else x.delete(l),U(l,a,r),T(t,l.prev,l.next),T(t,l,e===null?t.first:e.next),T(t,e,l),e=l;continue}for(u=[],h=[];a!==null&&a.k!==C;)(a.e.f&z)===0&&(x??=new Set).add(a),h.push(a),a=a.next;if(a===null)continue;l=a}u.push(l),e=l,a=l.next}let s=i.size>d;if(a!==null||x!==void 0){for(var o=x===void 0?[]:ae(x);a!==null;)(a.e.f&z)===0&&o.push(a),a=a.next;var f=o.length;if(s=i.size-f>d,f>0){var c=null;Pe(t,o,c)}}if(s)for(const p of i.values())p.o||(T(t,e,p),e=p);t.effect.last=e&&e.e}function He(t,n,r,_,m,d,i,a){var x=(i&ke)!==0,e=(i&ye)===0,u=x?e?F(r,!1,!1):X(r):r,h=(i&be)===0?m:X(m),b={i:h,v:u,k:_,a:null,e:null,o:!1,prev:n,next:null};try{if(t===null){var C=document.createDocumentFragment();C.append(t=te())}return b.e=Y(()=>d(t,u,h,a)),n!==null&&(n.next=b),b}finally{}}function U(t,n,r){for(var _=t.next?t.next.e.nodes_start:r,m=n?n.e.nodes_start:r,d=t.e.nodes_start;d!==null&&d!==_;){var i=Ee(d);m.before(d),d=i}}function T(t,n,r){n===null?(t.first=r,t.effect.first=r&&r.e):(n.e.next&&(n.e.next.prev=null),n.next=r,n.e.next=r&&r.e),r!==null&&(r.e.prev&&(r.e.prev.next=null),r.prev=n,r.e.prev=n&&n.e)}var Be=ne(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-xs text-white mb-1 font-mono"> </div> <div class="transition text-sm text-50"><!></div></a>`),Fe=ne(`<div id="search-bar" class="hidden lg:flex transition-all items-center h-11 mr-2 rounded-lg
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
"><!> <input placeholder="搜索" class="transition-all pl-10 text-sm bg-transparent outline-0
         h-full w-40 active:w-60 focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed search-panel absolute md:w-[30rem]
top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-2 svelte-1wah7ro"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input placeholder="Search" class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function Ge(t,n){Ne(n,!1);let r=F(""),_=F(""),m=F([]),d=[];const i=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},a=(s,o)=>{const f=document.getElementById("search-panel");!f||!o||(s?f.classList.remove("float-panel-closed"):f.classList.add("float-panel-closed"))},x=(s,o)=>{if(!o)return s;const f=new RegExp(`(${o})`,"gi");return s.replace(f,"<mark>$1</mark>")},e=async(s,o)=>{if(!s){a(!1,o),q(m,[]);return}try{const f=d.filter(c=>{const p=s.toLowerCase(),v=`${c.title} ${c.description} ${c.content}`.toLowerCase(),k=`/posts/${c.link}`;return v.includes(p)||k.toLowerCase().includes(p)||c.link.toLowerCase().includes(p)}).map(c=>{const p=c.content.toLowerCase(),v=s.toLowerCase(),k=p.indexOf(v);let y="";if(k!==-1){const $=Math.max(0,k-50),D=Math.min(c.content.length,k+100);y=c.content.substring($,D),$>0&&(y="..."+y),D<c.content.length&&(y=y+"...")}else y=c.description||c.content.substring(0,150)+"...";return{url:$e(`/posts/${c.link}/`),meta:{title:c.title},excerpt:x(y,s),urlPath:`/posts/${c.link}`}});q(m,f),a(g(m).length>0,o)}catch(f){console.error("Search error:",f),q(m,[]),a(!1,o)}finally{}};le(async()=>{try{const o=await(await fetch("/rss.xml")).text(),p=new DOMParser().parseFromString(o,"text/xml").querySelectorAll("item");d=Array.from(p).map(v=>{let k="";const y=v.getElementsByTagNameNS("*","encoded")[0]?.textContent||v.querySelector("*|encoded")?.textContent||"";return y&&(k=y.replace(/<[^>]*>/g,"")),{title:v.querySelector("title")?.textContent||"",description:v.querySelector("description")?.textContent||"",content:k,link:v.querySelector("link")?.textContent?.replace(/.*\/posts\/(.*?)\//,"$1")||""}})}catch(s){console.error("Error fetching RSS:",s)}}),W(()=>g(r),()=>{e(g(r),!0)}),W(()=>g(_),()=>{e(g(_),!1)}),Le(),se();var u=Fe(),h=Me(u),b=N(h);O(b,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var C=A(b,2);J(C),R(h);var l=A(h,2),I=N(l);O(I,{icon:"material-symbols:search",class:"text-[1.25rem]"}),R(l);var w=A(l,2),S=N(w),E=N(S);O(E,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var M=A(E,2);J(M),R(S);var L=A(S,2);qe(L,1,()=>g(m),De,(s,o)=>{var f=Be(),c=N(f),p=N(c,!0),v=A(p);O(v,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),R(c);var k=A(c,2),y=N(k,!0);R(k);var $=A(k,2),D=N($);ie(D,()=>(g(o),B(()=>g(o).excerpt))),R($),R(f),Re(()=>{oe(f,"href",(g(o),B(()=>g(o).url))),ee(p,(g(o),B(()=>g(o).meta.title))),ee(y,(g(o),B(()=>g(o).urlPath)))}),j(s,f)}),R(w),G(C,()=>g(r),s=>q(r,s)),Z("focus",C,()=>e(g(r),!0)),Z("click",l,i),G(M,()=>g(_),s=>q(_,s)),j(t,u),Ae()}export{Ge as default};
